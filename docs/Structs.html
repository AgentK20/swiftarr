<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Structures  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>

    <a name="//apple_ref/swift/Section/Structures" class="dashAnchor"></a>

    <a title="Structures  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          swiftarr 0.1.0
        </a>
         (100% documented)
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/grundoon/swiftarr">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">App Reference</a>
      <img class="carat" src="img/carat.png" />
      Structures  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Token.html">Token</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/User.html">User</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/User/Admin.html">– Admin</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/User/Header.html">– Header</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/User/Public.html">– Public</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/UserProfile.html">UserProfile</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/UserProfile/Private.html">– Private</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/UserProfile/Public.html">– Public</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/UserAccessLevel.html">UserAccessLevel</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:3App3appy5Vapor11ApplicationC7Service11EnvironmentVKF">app(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:3App4bootyy5Vapor11ApplicationCKF">boot(_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:3App9configureyy7Service6ConfigVz_AC11EnvironmentVzAC8ServicesVztKF">configure(_:_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:3App6routesyy5Vapor6Router_pKF">routes(_:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AdminUser.html">AdminUser</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AuthController.html">AuthController</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/RecoveryData.html">RecoveryData</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/TokenStringData.html">TokenStringData</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            <h1>Structures</h1>
            <p>The following structures are available globally.</p>

          </div>
        </section>

        <section class="section">
          <div class="section-content">
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3App14AuthControllerV"></a>
                    <a name="//apple_ref/swift/Struct/AuthController" class="dashAnchor"></a>
                    <a class="token" href="#/s:3App14AuthControllerV">AuthController</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>The collection of <code>/api/v3/auth/*</code> route endpoints and handler functions related
to authentication.</p>

<p>API v3 requires the use of either <code>HTTP Basic Authentication</code>
(<a href="https://tools.ietf.org/html/rfc7617">RFC7617</a>) or <code>HTTP Bearer Authentication</code> (based on
<a href="https://tools.ietf.org/html/rfc6750#section-2.1">RFC6750</a>) for virtually all endpoint
access, with very few exceptions carved out for fully public data (such as the Event
Schedule). The query-based <code>&amp;key=</code> scheme used in v2 is not supported at all.</p>

<p>This means that essentially all HTTP requests <strong><em>must</em></strong> contain an <code>Authorization</code> header.</p>

<p>A valid <code>HTTP Basic Authentication</code> header resembles:</p>
<pre class="highlight swift"><code><span class="kt">Authorization</span><span class="p">:</span> <span class="kt">Basic</span> <span class="kt">YWRtaW46cGFzc3dvcmQ</span><span class="o">=</span>
</code></pre>

<p>The data value in a Basic header is the base64-encoded utf-8 string representation of the
user&rsquo;s username and password, separated by a colon. In Swift, a one-off version might resemble
something along the lines of:</p>
<pre class="highlight swift"><code><span class="k">var</span> <span class="nv">request</span> <span class="o">=</span> <span class="kt">URLRequest</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">credentials</span> <span class="o">=</span> <span class="s">"username:password"</span><span class="o">.</span><span class="nf">data</span><span class="p">(</span><span class="nv">using</span><span class="p">:</span> <span class="o">.</span><span class="n">utf8</span><span class="p">)</span><span class="o">.</span><span class="nf">base64encodedString</span><span class="p">()</span>
<span class="n">request</span><span class="o">.</span><span class="nf">addValue</span><span class="p">(</span><span class="s">"Basic </span><span class="se">\(</span><span class="n">credentials</span><span class="se">)</span><span class="s">"</span><span class="p">,</span> <span class="nv">forHTTPHeaderField</span><span class="p">:</span> <span class="s">"Authorization"</span><span class="p">)</span>
<span class="o">...</span>
</code></pre>

<p>Successful execution of sending this request to the login endpoint returns a JSON-encoded
token string:</p>
<pre class="highlight swift"><code><span class="p">{</span>
    <span class="s">"token"</span><span class="p">:</span> <span class="s">"y+jiK8w/7Ta21m/O8F2edw=="</span>
<span class="p">}</span>
</code></pre>

<p>which is then used in <code>HTTP Bearer Authentication</code> for all subsequent requests:</p>
<pre class="highlight swift"><code><span class="kt">Authorization</span><span class="p">:</span> <span class="kt">Bearer</span> <span class="n">y</span><span class="o">+</span><span class="n">jiK8w</span><span class="o">/</span><span class="mi">7</span><span class="kt">Ta21m</span><span class="o">/</span><span class="kt">O8F2edw</span><span class="o">==</span>
</code></pre>

<p>A generated token string remains valid across all clients on all devices until the user
explicitly logs out, or it otherwise expires or is administratively deleted. If the user
explicitly logs out on <em>any</em> client on <em>any</em> device, the token is deleted and the
<code>/api/v3/auth/login</code> endpoint will need to be hit again to generate a new one.</p>

                        <a href="Structs/AuthController.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">AuthController</span> <span class="p">:</span> <span class="kt">RouteCollection</span></code></pre>

                        </div>
                      </div>
                      <div class="slightly-smaller">
                        <a href="https://github.com/grundoon/swiftarr/tree/master/Sources/App/Controllers/AuthController.swift#L45-L294">Show on GitHub</a>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <div class="task-name-container">
                <a name="/Helper%20Structs"></a>
                <a name="//apple_ref/swift/Section/Helper Structs" class="dashAnchor"></a>
                <a href="#/Helper%20Structs">
                  <h3 class="section-name">Helper Structs</h3>
                </a>
              </div>
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3App12RecoveryDataV"></a>
                    <a name="//apple_ref/swift/Struct/RecoveryData" class="dashAnchor"></a>
                    <a class="token" href="#/s:3App12RecoveryDataV">RecoveryData</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Used by <code><a href="Structs/AuthController.html#/s:3App14AuthControllerV15recoveryHandler_4data3NIO15EventLoopFutureCyAA15TokenStringDataVG5Vapor7RequestC_AA08RecoveryM0VtKF">AuthController.recoveryHandler(_:data:)</a></code> for the incoming recovery attempt.</p>

                        <a href="Structs/RecoveryData.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">RecoveryData</span> <span class="p">:</span> <span class="kt">Content</span></code></pre>

                        </div>
                      </div>
                      <div class="slightly-smaller">
                        <a href="https://github.com/grundoon/swiftarr/tree/master/Sources/App/Controllers/AuthController.swift#L299-L304">Show on GitHub</a>
                      </div>
                    </section>
                  </div>
                </li>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3App15TokenStringDataV"></a>
                    <a name="//apple_ref/swift/Struct/TokenStringData" class="dashAnchor"></a>
                    <a class="token" href="#/s:3App15TokenStringDataV">TokenStringData</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>Used by <code><a href="Structs/AuthController.html#/s:3App14AuthControllerV12loginHandlery3NIO15EventLoopFutureCyAA15TokenStringDataVG5Vapor7RequestCKF">AuthController.loginHandler(_:)</a></code> and <code><a href="Structs/AuthController.html#/s:3App14AuthControllerV15recoveryHandler_4data3NIO15EventLoopFutureCyAA15TokenStringDataVG5Vapor7RequestC_AA08RecoveryM0VtKF">AuthController.recoveryHandler(_:data:)</a></code>
to return a token string upon successful execution.</p>

                        <a href="Structs/TokenStringData.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">TokenStringData</span> <span class="p">:</span> <span class="kt">Content</span></code></pre>

                        </div>
                      </div>
                      <div class="slightly-smaller">
                        <a href="https://github.com/grundoon/swiftarr/tree/master/Sources/App/Controllers/AuthController.swift#L308-L316">Show on GitHub</a>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul class="item-container">
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:3App9AdminUserV"></a>
                    <a name="//apple_ref/swift/Struct/AdminUser" class="dashAnchor"></a>
                    <a class="token" href="#/s:3App9AdminUserV">AdminUser</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A <code>Migration</code> that creates the admin user upon startup. The password and recovery key are
read from environment variables <code>ADMIN_PASSWORD</code> and <code>RECOVERY_KEY</code> if present, otherwise
defaults are used.</p>

<p>The defaults are intended and fine for development and testing, but should <strong>never</strong> be
used in production. If not set to proper values in <code>docker-compose.yml</code> (or whatever
other environment of your choice), reminders are printed to console during startup.</p>

                        <a href="Structs/AdminUser.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">struct</span> <span class="kt">AdminUser</span> <span class="p">:</span> <span class="kt">Migration</span></code></pre>

                        </div>
                      </div>
                      <div class="slightly-smaller">
                        <a href="https://github.com/grundoon/swiftarr/tree/master/Sources/App/Migrations/AdminUser.swift#L13-L73">Show on GitHub</a>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </section>

      </article>
    </div>
    <section class="footer">
      <p>&copy; 2019 <a class="link" href="" target="_blank" rel="external">grundoon</a>. All rights reserved. (Last updated: 2019-10-31)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.11.2</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
